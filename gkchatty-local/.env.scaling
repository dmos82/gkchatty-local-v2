# GKChatty Scaling Configuration
# Copy this to .env and adjust for your environment
# This configuration supports 50+ concurrent users

# ============================================
# CRITICAL FOR 50+ USERS
# ============================================

# Redis Configuration (REQUIRED for distributed rate limiting with multiple instances)
REDIS_URL=redis://localhost:6379
# For production with TLS:
# REDIS_URL=rediss://your-redis-host:6380
# REDIS_PASSWORD=your-redis-password

# Node Environment
NODE_ENV=production

# ============================================
# PERFORMANCE TUNING
# ============================================

# Increase Node.js memory limit (for each PM2 instance)
NODE_OPTIONS="--max-old-space-size=2048"

# OpenAI Configuration
OPENAI_HTTP_TIMEOUT_MS=60000
OPENAI_MAX_COMPLETION_TOKENS=4096

# MongoDB Connection Pool
# Add this to your MongoDB connection string:
# mongodb://...?maxPoolSize=200&minPoolSize=10

# ============================================
# RATE LIMITING (Already configured in constants.ts)
# ============================================
# Current Production Limits:
# - Auth: 5 req/min
# - AI/Chat: 500 req/min (supports 50+ users)
# - Upload: 150 req/5min
# - Standard API: 100 req/15min

# To override (not recommended, edit constants.ts instead):
# RATE_LIMIT_AI_MAX_OVERRIDE=1000

# ============================================
# PM2 CLUSTER MODE
# ============================================
# Configure in ecosystem.config.js
# instances: 4 (or number of CPU cores)
# exec_mode: 'cluster'

# ============================================
# MONITORING (Recommended)
# ============================================
# PM2 Plus (optional monitoring)
# PM2_PUBLIC_KEY=your-key
# PM2_SECRET_KEY=your-secret

# New Relic (optional)
# NEW_RELIC_LICENSE_KEY=your-license-key
# NEW_RELIC_APP_NAME=gkchatty-production

# ============================================
# LOGGING
# ============================================
LOG_LEVEL=info
# Use 'debug' for troubleshooting, 'error' for production

# ============================================
# CORS (for multiple frontend instances)
# ============================================
CORS_ORIGINS=http://localhost:4003,https://your-domain.com

# ============================================
# SESSION MANAGEMENT
# ============================================
# JWT token expiry (reduce for better security with more users)
JWT_EXPIRES_IN=24h

# ============================================
# OPTIONAL: Queue Configuration (Bull)
# ============================================
# If implementing request queuing
BULL_REDIS_URL=redis://localhost:6379
QUEUE_CONCURRENCY=10
QUEUE_MAX_JOBS=1000

# ============================================
# OPTIONAL: CDN for Static Assets
# ============================================
# CDN_URL=https://cdn.your-domain.com

# ============================================
# DEPLOYMENT NOTES
# ============================================
# 1. Install Redis: redis-server or use Redis Cloud
# 2. Start PM2: pm2 start ecosystem.config.js --env production
# 3. Monitor: pm2 monit
# 4. Save PM2 config: pm2 save
# 5. Auto-start on reboot: pm2 startup